name: Triage pull requests and issues
on:
  issues:
    types: [opened]
  pull_request_target:
    types: [opened]

jobs:
  apply-label:
    runs-on: ubuntu-latest
    steps:
      - name: View context attributes
        uses: actions/github-script@v7
        with:
          script: console.log(context)
      - name: Check for existing labels
        id: label-check
        uses: actions/github-script@v7
        with:
          script: |
            const issue = context.issue;
            const pr = context.pull_request;
            let hasLabels = false;
            console.log(hasLabels)

            if (issue) {
              hasLabels = issue.labels && issue.labels.length > 0;
              console.log(issue.labels.length)
            } else if (pr) {
              hasLabels = pr.labels && pr.labels.length > 0;
              console.log(pr.labels.length)
            }

            console.log(hasLabels)
            console.log('Is there any label? '+hasLabels)
            return hasLabels
      - name: Label issues and PRs
        uses: github/issue-labeler@v3.4
        with:
          configuration-path: .github/labeler.yml
          enable-versioned-regex: 0
          repo-token: ${{ secrets.GITHUB_TOKEN }}
